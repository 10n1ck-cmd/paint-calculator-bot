<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<title>–ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä –ø–æ—Ä–æ—à–∫–æ–≤–æ–π –∫—Ä–∞—Å–∫–∏</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<style>
body{font-family:Arial;background:#f4f6f8;padding:15px}
.container{max-width:900px;margin:auto;background:#fff;padding:20px;border-radius:10px}
input,select,button{width:100%;padding:10px;margin-top:5px}
button{background:#2d7ef7;color:#fff;font-size:16px;margin-top:15px}
.hidden{display:none}
table{width:100%;border-collapse:collapse;margin-top:20px}
th,td{border:1px solid #ccc;padding:8px;text-align:center}
.good{background:#e6ffe6}
.bad{background:#ffecec}
</style>
</head>

<body>
<div class="container">
<h1>üé® –ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä</h1>

<select id="calcType">
<option value="theoretical">–¢–µ–æ—Ä–µ—Ç–∏—á–µ—Å–∫–∏–π</option>
<option value="practical">–ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–π</option>
</select>

<input id="product_area" placeholder="–ü–ª–æ—â–∞–¥—å –º¬≤">

<input id="p1_name" placeholder="–ö—Ä–∞—Å–∫–∞ 1">
<input id="p1_density" placeholder="–ü–ª–æ—Ç–Ω–æ—Å—Ç—å / –†–∞—Å—Ö–æ–¥">
<input id="p1_thickness" placeholder="–¢–æ–ª—â–∏–Ω–∞">
<input id="p1_price" placeholder="–¶–µ–Ω–∞">

<input id="p2_name" placeholder="–ö—Ä–∞—Å–∫–∞ 2">
<input id="p2_density" placeholder="–ü–ª–æ—Ç–Ω–æ—Å—Ç—å / –†–∞—Å—Ö–æ–¥">
<input id="p2_thickness" placeholder="–¢–æ–ª—â–∏–Ω–∞">
<input id="p2_price" placeholder="–¶–µ–Ω–∞">

<button onclick="calc()">–†–∞—Å—Å—á–∏—Ç–∞—Ç—å</button>
<button onclick="pdf()">üìÑ –°–∫–∞—á–∞—Ç—å PDF</button>

<pre id="out"></pre>
</div>

<script>
let last=null
const num=v=>parseFloat(String(v).replace(',','.'))||0

async function calc(){
const d={
calc_type:calcType.value,
product_area:num(product_area.value),
paint1:{
name:p1_name.value,
density:num(p1_density.value),
thickness:num(p1_thickness.value),
real_consumption:num(p1_density.value),
price:num(p1_price.value)
},
paint2:{
name:p2_name.value,
density:num(p2_density.value),
thickness:num(p2_thickness.value),
real_consumption:num(p2_density.value),
price:num(p2_price.value)
}
}
const r=await fetch('/api/calculate',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify(d)})
last=(await r.json()).result
out.textContent=JSON.stringify(last,null,2)
}

async function pdf(){
if(!last){alert('–°–Ω–∞—á–∞–ª–∞ —Ä–∞—Å—Å—á–∏—Ç–∞–π—Ç–µ');return}
const r=await fetch('/api/pdf',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify(last)})
const b=await r.blob()
const a=document.createElement('a')
a.href=URL.createObjectURL(b)
a.download='calculation.pdf'
a.click()
}
</script>
</body>
</html>
